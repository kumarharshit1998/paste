@{
    ViewData["Title"] = "Excel Import";
    var stage = ViewBag.Stage as string ?? "upload";
    var sheetNames = ViewBag.SheetNames as List<string>;
}

<h2>Bulk Import</h2>

@if (stage == "upload")
{
    <form asp-action="BulkImport" method="post" enctype="multipart/form-data">
        <input type="hidden" name="stage" value="upload" />
        <div>
            <label>Select Excel File:</label>
            <input type="file" name="ExcelFile" required />
        </div>
        <div>
            <button type="submit">Upload Spreadsheet</button>
        </div>
    </form>
}
else if (stage == "selectSheet")
{
    <form asp-action="BulkImport" method="post">
        <input type="hidden" name="stage" value="sheetSelected" />
        <div>
            <label>Select Sheet:</label>
            <select name="SelectedSheet" required>
                @foreach (var sheet in sheetNames)
                {
                    <option value="@sheet">@sheet</option>
                }
            </select>
        </div>
        <div>
            <button type="submit">Next</button>
        </div>
    </form>
}
else if (stage == "mapColumns")
{
    <p>You selected sheet: <strong>@ViewBag.SelectedSheet</strong></p>
    <!-- Placeholder for column mapping screen -->
}
