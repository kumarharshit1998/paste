@{
    ViewData["Title"] = "Upload Excel";
    var showSheetSelector = ViewBag.ShowSheetSelector != null && (bool)ViewBag.ShowSheetSelector;
    var sheetNames = ViewBag.SheetNames as List<string>;
}

<h2>Upload Excel</h2>

@if (!showSheetSelector)
{
    <form asp-action="Upload" asp-controller="Excel" method="post" enctype="multipart/form-data">
        <input type="file" name="ExcelFile" accept=".xlsx" required />
        <button type="submit">Upload Spreadsheet</button>
    </form>
}
else
{
    <table border="1" cellpadding="10">
        <tr>
            <th colspan="2" style="text-align:left; background-color:#f2f2f2;">
                SHAW Autofill Sheet Options
            </th>
        </tr>
        <tr>
            <td>Choose Sheet Tab:</td>
            <td>
                <form asp-action="MapColumns" asp-controller="Excel" method="post">
                    <select name="SelectedSheet" required>
                        @foreach (var sheet in sheetNames)
                        {
                            <option value="@sheet">@sheet</option>
                        }
                    </select>
                    <button type="submit">NEXT</button>
                </form>
            </td>
        </tr>
    </table>
}

@if (ViewBag.Error != null)
{
    <p style="color:red">@ViewBag.Error</p>
}
